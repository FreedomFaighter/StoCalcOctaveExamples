with(linalg):
P:=matrix(6,6,[1,1/4,1/16,0,0,0,0,1/2,1/4,0,0,0,0,1/4,1/4,1/4,1,0,0,0,1/4,1/2,0,0,0,0,1/8,0,0,0, 0,0,1/16,1/4,0,1]):
T:=matrix(4,4,[1/2,1/4,0,0,1/4,1/4,1,0,0,1/4,1/2,0,0,1/8,0,0]):
p0:=vector([0,1,0,0,0,0]):
h0:=1/2*p0[2]+p0[3]+1/2*p0[4]:
p:=n->evalm(P^n&*p0):
h:=n->1/2*p(n)[2]+p(n)[3]+1/2*p(n)[[4]:
evalm(p(3)); h(3);
ll:=[eigenvals(P)];
f:=n->a*ll[1]^n+b*ll[2]^n+c*ll[3]^n+d*ll[4]^n:
solve({f(0)=p0,f(1)=q(1),f(2)=q(2),f(3)=q(3)},{a,b,c,d});
evalf(subs({a=0,b=0,c1/4+3/20*sqrt(5),d=1/4-3/20*sqrt(5)},f(20)));
evalf(subs({a=0,b=0,c=1/4+3/20*sqrt(5),d=1/4-3/20*sqrt(5)},f(30)));